多线程、多进程概念
=== 
## 并发
之前写的程序都是单进程单线程，好像一条车道，先干一个功能再干一个功能。
缺点场景：天堂图片网爬虫，下载速度峰值7m/s，天堂图片网服务器上下对等带宽20m/s，网站在线100人，在某5s中同时请求网站图片的有10人，平均提供一个人的服务只剩20/10=2m/s。另一种情况对每一个请求进行限速，每张图片最高下载速度1m/s。之前的脚本爬取一张图片后要等待完成才能循环请求下一张图片，如果某一张图片网络速度不好，影响到后面的速度。改进方式是利用并发多张图片同时下载。
## 常见实现
- 多线程。 优点：新增线程简单。 缺点：死锁。由于python全局锁机制无法发挥机器全部性能。
- 多进程。 优点：资源独立。  缺点：新建进程消耗较多的系统资源。
- 协程。   优缺点类似多线程。跟多线程多进程完全不是一种东西，代码层面上的。
## 多线程、多进程介绍
比喻：进程好像一条大马路，线程就好像马路上的机动车道，四车道。
### 线程
系统进行运算调度的最小单位。包含在进程之中，进程中的实际运算单位。一个进程中并发多个线程，每个线程执行任务，是execution context 执行上下文环境，即一串cpu指令。
好像一本书，中间需要吃饭，就把这本书的页码数、行数（execution context）记录下来。吃完饭根据context接着读着本书。

cpu运算原理：cpu运算速度非常快，远高于内容和硬盘。当电脑同时运行qq、微信、pycharm、浏览器。实际上cpu只在每个程序上停留计算几微秒，然后保存qq运行现场（context），挂起qq，再切换到pycharm，重复上面操作。在不同程序快速切换。 实现任务的轮转调度，好像这些任务在同时执行一样。

### 进程
一个程序的执行实例是一个进程。一个进程包含运行所需资源的集合。资源的集合包括地址，代码，操作系统接口，权限用户、进程id、环境变量、内存空间、优先级。
一个进程包含一个或多个线程，先创建一个主线程，然后创建其它子线程。
新建一个进程需要对主进程进行复制，资源独立，一个崩溃不影响其它进程，新建进程消耗的系统资源较多。
多进程例如谷歌浏览器。

## 多线程、多进程比较
1. 线程共享内存空间，进程之间独立
2. 线程可以相互通讯，进程无法直接传递数据，需要中间代理负责发送接收数据。
3. 对主线程修改影响到其它线程。对父进程修改不影响其它进程。
4. 线程是一串cpu指令，进程是资源簇。
5. 创建线程容易，创建进程需要消耗更多资源。





